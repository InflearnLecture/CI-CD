# Develonity
> `Developer` + `Community` = `Develonity` 
- **입문 & 주니어 & 시니어 개발자 모두에게 가치 있는 커뮤니티를 만들고자 했습니다.**
- Q&A 게시판 활동(답변)을 통해 `Gift Point` 를 쌓고, 포인트로 `Gift Card` 를 살 수 있습니다.
- [미구현] Q&A 게시판 활동(답변)을 통해 단순히 `Gift Point` 뿐만 아니라 `Respect Point` 가 쌓이게 되고, `Respect Point` 를 기반으로 `외주, 과외 등의 서비스` 를 제공하고자 했습니다.

![브로셔메인페이지](https://user-images.githubusercontent.com/116135174/224562613-25b15240-4157-4a6c-a908-69a7a942bf95.PNG)

팀원 소개 👨‍👩‍👧‍👦
---



| [조성현](https://github.com/dangddoong) | [이솔](https://github.com/LEESOLL) | [김태웅](https://github.com/ultramancode) | [배지호](https://github.com/2Luda) | [송성원](https://github.com/SungWonSong) |
| --- | --- | --- | --- | --- |
| 1 | 2 | 3 | 4 | 5 |
| 6 | 7 | 8 | 9 | 10 |
| 11 | 12 | 13 | 14 | 15 | 




서비스 아키텍쳐📖
---

![서비스아키텍처](https://user-images.githubusercontent.com/116135174/224563517-e0caea58-799d-481c-958c-0c505306c922.png)


기술 스택 💻
---
Front-End 

![68747470733a2f2f696d672e736869656c64732e696f2f62616467652f48544d4c2d4533344632363f7374796c653d666c6174266c6f676f3d68746d6c35266c6f676f436f6c6f723d7768697465](https://user-images.githubusercontent.com/116135174/224563690-49f7978a-08cc-444e-b68d-25f8f3dca096.svg)
![68747470733a2f2f696d672e736869656c64732e696f2f62616467652f4353532d3135373242363f7374796c653d666c6174266c6f676f3d63737333266c6f676f436f6c6f723d7768697465](https://user-images.githubusercontent.com/116135174/224563708-a893b2d2-3a9f-437c-90f9-2fb1e4b5d59c.svg)
<img src="https://img.shields.io/badge/Visual Studio-5C2D91?style=flat&logo=Visual Studio&logoColor=white">
<img src="https://img.shields.io/badge/jQuery-0769AD?style=flat&logo=jQuery&logoColor=white">
<img src="https://img.shields.io/badge/JavaScript-F7DF1E?style=flat&logo=JavaScript&logoColor=white">

Back-End 

![68747470733a2f2f696d672e736869656c64732e696f2f62616467652f4a6176612d3030373339363f7374796c653d666c6174266c6f676f3d4f70656e4a444b266c6f676f436f6c6f723d7768697465](https://user-images.githubusercontent.com/116135174/224563807-67c19880-4cf0-4dff-864e-8c0b5e334d26.svg)
![68747470733a2f2f696d672e736869656c64732e696f2f62616467652f537072696e675f426f6f742d3644423333463f7374796c653d666c6174266c6f676f3d737072696e67626f6f74266c6f676f436f6c6f723d7768697465](https://user-images.githubusercontent.com/116135174/224563810-e6bf9887-21e0-4335-b363-4a06d47ff332.svg)
![68747470733a2f2f696d672e736869656c64732e696f2f62616467652f537072696e672d3644423333463f7374796c653d666c6174266c6f676f3d537072696e67266c6f676f436f6c6f723d7768697465](https://user-images.githubusercontent.com/116135174/224563819-60e7b43b-41d8-48c4-9ff5-8d920274f05e.svg)
![68747470733a2f2f696d672e736869656c64732e696f2f62616467652f537072696e675f446174615f4a50412d3644423333463f7374796c653d666c6174](https://user-images.githubusercontent.com/116135174/224563822-34f5705d-1a3a-40c2-92cb-53476f64019f.svg)
![68747470733a2f2f696d672e736869656c64732e696f2f62616467652f537072696e675f53656375726974792d3644423333463f7374796c653d666c6174266c6f676f3d737072696e677365637572697479266c6f676f436f6c6f723d7768697465](https://user-images.githubusercontent.com/116135174/224563832-48210ac1-d1a8-4712-8f58-d2bbeab82e0a.svg)
![68747470733a2f2f696d672e736869656c64732e696f2f62616467652f52656469732d4443333832443f7374796c653d666c6174266c6f676f3d7265646973266c6f676f436f6c6f723d7768697465](https://user-images.githubusercontent.com/116135174/224563838-7056f1cc-45dd-4468-8f62-a28f93c0bc7c.svg)
![68747470733a2f2f696d672e736869656c64732e696f2f62616467652f517565727944736c2d3430414546303f7374796c653d666c6174](https://user-images.githubusercontent.com/116135174/224563844-c776b411-7082-4d18-ac10-16f81ebffbe9.svg)
![68747470733a2f2f696d672e736869656c64732e696f2f62616467652f4a57542d4139323235433f7374796c653d666c6174](https://user-images.githubusercontent.com/116135174/224563850-b63732e7-71f6-4f82-89d5-f8bddc791feb.svg)
![68747470733a2f2f696d672e736869656c64732e696f2f62616467652f477261646c652d3032333033413f7374796c653d666c6174266c6f676f3d677261646c65266c6f676f436f6c6f723d7768697465](https://user-images.githubusercontent.com/116135174/224563860-f3344686-f5e5-472a-88d1-2f47a136a82a.svg)
![68747470733a2f2f696d672e736869656c64732e696f2f62616467652f48696265726e6174652d3539363636433f7374796c653d666c6174266c6f676f3d48696265726e617465266c6f676f436f6c6f723d7768697465](https://user-images.githubusercontent.com/116135174/224563866-331e0ce4-ee26-444c-9660-89ca9d191dab.svg)
![68747470733a2f2f696d672e736869656c64732e696f2f62616467652f506f73746d616e2d4646364333373f7374796c653d666c6174266c6f676f3d506f73746d616e266c6f676f436f6c6f723d7768697465](https://user-images.githubusercontent.com/116135174/224563871-9ccb51f3-1be2-45d0-ab1f-e4d792e049dd.svg)
<img src="https://img.shields.io/badge/JUnit5-25A162?style=flat&logo=JUnit5&logoColor=white">
<img src="https://img.shields.io/badge/MySQL-4479A1?style=flat&logo=MySQL&logoColor=white">

Server 

![68747470733a2f2f696d672e736869656c64732e696f2f62616467652f416d617a6f6e5f53332d3536394133313f7374796c653d666c6174266c6f676f3d616d617a6f6e7333266c6f676f436f6c6f723d7768697465](https://user-images.githubusercontent.com/116135174/224563965-0407b444-b4dc-4fcd-8060-5c0cac870f57.svg)
![68747470733a2f2f696d672e736869656c64732e696f2f62616467652f416d617a6f6e5f4543322d4646393930303f7374796c653d666c6174266c6f676f3d616d617a6f6e656332266c6f676f436f6c6f723d7768697465](https://user-images.githubusercontent.com/116135174/224563977-98fc9d8d-1820-4881-aa81-e593585c570f.svg)
![68747470733a2f2f696d672e736869656c64732e696f2f62616467652f416d617a6f6e5f5244532d3532374646463f7374796c653d666c6174266c6f676f3d616d617a6f6e726473266c6f676f436f6c6f723d7768697465](https://user-images.githubusercontent.com/116135174/224565820-02995aae-65b8-4bdb-ad84-06500f32741d.svg)


Etc ⛓️

![68747470733a2f2f696d672e736869656c64732e696f2f62616467652f4769746875622d3138313731373f7374796c653d666c6174266c6f676f3d676974687562266c6f676f436f6c6f723d7768697465](https://user-images.githubusercontent.com/116135174/224564009-4100e123-0818-44f8-acba-bc5d0540d66c.svg)
<img src="https://img.shields.io/badge/GitHub Actions-2088FF?style=flat&logo=GitHub Actions&logoColor=white">
![68747470733a2f2f696d672e736869656c64732e696f2f62616467652f536c61636b2d3441313534423f7374796c653d666c6174266c6f676f3d736c61636b266c6f676f436f6c6f723d7768697465](https://user-images.githubusercontent.com/116135174/224564017-f1c15951-64d8-4352-866a-12ca984e6424.svg)
![68747470733a2f2f696d672e736869656c64732e696f2f62616467652f4e6f74696f6e2d3030303030303f7374796c653d666c6174266c6f676f3d6e6f74696f6e266c6f676f436f6c6f723d7768697465](https://user-images.githubusercontent.com/116135174/224564022-db759b69-a20d-4ec6-9bdb-7fa96bf36d69.svg)
<img src="https://img.shields.io/badge/Jira-0052CC?style=flat&logo=Jira&logoColor=white">

기술적 의사결정 📋
---
<details>
<summary>Session vs Token(JWT)</summary><br>

Session vs Token(JWT)<br><br>

- 보안 vs 효율&확장성
- 서비스의 특성상(커뮤니티) 보안적으로 매우 민감한 주제는 아니라고 판단<br>
- HTTP의 비상태성(Stateless)를 그대로 활용할 수 있고, 따라서 높은 확장성을 가질 수 있는 Token방식을 채택
<br>

> 그럼에도 보안을 챙기긴 해야한다.

<br>

- refresh token을 도입하여 access token의 유효기간을 짧게 가져가고,
- RTR(refresh token rotation)을 도입하여 refresh token 탈취 시 문제점도 어느정도 보완,
- 계정정보 or 회원탈퇴 등 중요한 기능들은 ‘비밀번호 검증＇을 1회 더 하는 방식으로 보안을 조금 더 강화.

<br> 

> access token과 refresh token이 모두 탈취 당했을 경우에 대한 고민

[네이버 토큰 갱신방법[grant_type, client id를 같이 보내는 방식]](https://developers.naver.com/docs/login/devguide/devguide.md#5-1-2-%EA%B0%B1%EC%8B%A0-%ED%86%A0%ED%81%B0%EC%97%90-%EB%8C%80%ED%95%98%EC%97%AC:~:text=Authorization%3A%20Bearer%20ACCESS_TOKEN-,5.1.2%20%EA%B0%B1%EC%8B%A0%20%ED%86%A0%ED%81%B0%EC%97%90%20%EB%8C%80%ED%95%98%EC%97%AC,-%EC%A0%91%EA%B7%BC%20%ED%86%A0%ED%81%B0%EC%9D%80%20%EC%A0%91%EA%B7%BC)

[카카오 토큰 갱신방법[네이버와 유사]](https://developers.kakao.com/docs/latest/ko/kakaologin/rest-api#refresh-token:~:text=%3A1234%0A%7D-,%ED%86%A0%ED%81%B0%20%EA%B0%B1%EC%8B%A0%ED%95%98%EA%B8%B0,-%EA%B8%B0%EB%B3%B8%20%EC%A0%95%EB%B3%B4)

**현재 프로젝트에서 대응 가능한 방법들**

1. **사용자가 서비스를 지속적으로 이용중인 상황**
- RTR(refresh token rotation)을 적용하고 access token의 유효시간을 30분으로 짧게 설정해두어, `[reissue 실패 → 재로그인 → 탈취된 refresh token 무효화]`가 가능하다.
1. **토큰이 지속적으로 탈취되는 상황**
- 해당 회원을 일단 `탈퇴처리` 하여 해커의 `나쁜 행동을 막고`  개인적으로 네트워크와 컴퓨터를 리셋(포맷)한 이후에 다시 `계정을 복구` 하는 방법이 있다. (회원 탈퇴는 soft delete 방식으로 구현되어 가능하다.)
1. **특정 상황이 발생하여 회원 다수의 token이 탈취된 경우** 

`30분여 서비스 점검 실시(access token 유효기간 만료를 위함) 및` 
`redis(refresh token 저장소)를 재가동` 하는 방법도 고려할 수 있다. (서비스 점검기간동안 보안적인 대처도 병행)
- +현재 계정정보 접근, 회원탈퇴 등 민감한 서비스들에는 `패스워드 재검증 로직`을 포함하고 있으므로 `개인정보 유출, 금전적 피해` 가 발생 가능한 경우는 예방하고 있다.</details>

<details>
<summary>Redis - Token 저장소로 Redis를 선정한 이유</summary><br>


- 
1. ~~Key(LoginId)-Value(Refresh Token) 외의 다른 필드가 필요하지 않다.~~
2.  I/O가 빈번하게 발생하는 환경
3. 저장된 데이터의 개수와 무관하게 `O(1)` 의 수행시간을 가진다. 
4. 저장된 모든 token을 조회하는 등의 싱글 스레드의 단점이 부각 될 상황이 없다.
</details>

<details>
<summary>Admin과 User 분리</summary><br>


**기존 방식**

- 동일한 User Entity에서 `Role Enum` 으로 Admin과 User를 구분하였음
- 동일한 security filter와  Authentication Service를 사용하였음.

**문제점**

- 근본적으로 User와 Admin의 생명주기가 다르고,
- User와 Admin의 역할과 그에 따른 기능들이 다르다.
- User와 Admin의 인증과정을 분리할 수 없음.

**해결**

- Entity 및 Package 분리
- security filter와  Authentication Service 분리
- Authentication Service에 `팩토리 패턴` 적용하여 OCP 원칙을 지키고자 노력
</details>

<details>
<summary>게시글 JPA 상속 관계 매핑(단일 테이블 전략)</summary><br>



JPA는 테이터베이스와 객체를 매핑해주는 자바 진영의 ORM 기술 표준이지만 객체의 상속 관계와 정확하게 일치하는 데이터베이스 모델링은 존재하지 않는다.

따라서 차선책으로 상속 관계와 비교적 유사한 **슈퍼타입-서브타입** 모델링 기법으로 데이터베이스를 상속 객체에 매핑 해야 한다.

슈퍼타입-서브타입 논리모델을 실제 데이터베이스 물리모델로 구현하는 방법으로 3가지 전략이 있는데 그 중 단일 테이블 전략을 사용했다.

단일 테이블 전략의 **장점**은 아래와 같다.

- 조인이 필요 없으므로 조회 성능이 빠르다.
- 조회 쿼리가 단순하다.

단일 테이블의 **단점**은 아래와 같다.

- 하위 엔티티의 필드값은 모두 Null을 허용한다.
- 하나의 테이블에 칼럼이 많아져 복잡하다.

단점이 있음에도 **단일 테이블 전략을** **선택한 이유**는 아래와 같다.

- 지금 진행 중인 프로젝트는 게시글의 필드값을 최대한 적게 가져가는 방식을 사용하고 있어서 테이블 칼럼 수가 적고 가볍기 때문에 단일 테이블 전략을 사용하더라도 복잡해지지 않는다.
- 비록 데이터베이스에는 Null값을 허용하더라도 실제 객체가 Null값을 가지고 있는 것은 아니다.

만약 단일 테이블 전략이 아니라 각자 테이블을 가지는 조인 전략과 같은 방식을 사용했다면 Null값은 들어가지 않지만 조회 쿼리가 복잡해지고 INSERT QUERY를 2번 실행해야 하기 때문에 

단일 테이블 전략을 사용하기로 결정했다. 
</details>

<details>
<summary>id를 활용한 간접참조 방식 설계</summary><br>

- **직접 참조** : Entity 클래스를 설계할 때 @OneToOne, @OneToMany ... 와 같은 어노테이션을 써서 Entity 간에 연관 매핑하는 것
- **간접 참조** : 객체를 직접 참조하지 않고, 식별값을 이용하는 것

- **직접 참조 방식의 단점**
- 의존 관계 형성
- 편한 탐색 오용 방지
- 직접 참조를 한다면 연관 관계 맺은 객체를 편하게 탐색할 수 있고 바뀌길 원하지 않는 참조 객체의 값이 손쉽게 바뀔 가능성이 있다. 직접 참조는 편한만큼 위험한 것이다.
- 예를 들어 Board Entity안에 user라는 변수가 있다면 Board를 다룰 때 User를 변경할 수 있는 가능성과 여러 실수의 가능성이 존재하게 됨
- 즉 User 라는 Entity 자체를 날것으로 가져오게 되면, Entity 가 오염이 될 수 도 있음, setter 를 통해서든, 도메인 서비스를 통해서든 어떤 일이 벌어질 수 있는 가능성을 열어둔 것
- **결론**

User Entity도 안전하게 보호가 되고, Board Entity에만 집중할 수 있는 방법으로 **간접 참조** 방식을 ****이용하는 것이 나을 것이라고 판단했고,

간접 참조를 하면 의존 관계가 형성되지 않아서 추후 시스템을 확장할 때도 유리하기 때문에 

**간접 참조 방식을 이용해서 설계를 하게 됐다.**
</details>

<details>
<summary>이미지 서버로 AWS S3 사용하게 된 이유</summary><br>
</details>

</details>




트러블 슈팅 📌
---
<details></details>
<details>
